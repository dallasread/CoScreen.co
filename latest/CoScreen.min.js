/*! CoScreen-0.0.1.min.js 11-01-2014 */
(function(){function a(b,c){(null===b||void 0===b)&&a.warn("Warning","You must pass your app key when you instantiate Pusher.");var c=c||{},d=this;this.key=b,this.config=a.Util.extend(a.getGlobalConfig(),c.cluster?a.getClusterConfig(c.cluster):{},c),this.channels=new a.Channels,this.global_emitter=new a.EventsDispatcher,this.sessionID=Math.floor(1e9*Math.random()),this.timeline=new a.Timeline(this.key,this.sessionID,{features:a.Util.getClientFeatures(),params:this.config.timelineParams||{},limit:50,level:a.Timeline.INFO,version:a.VERSION}),this.config.disableStats||(this.timelineSender=new a.TimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline"})),this.connection=new a.ConnectionManager(this.key,a.Util.extend({getStrategy:function(b){return a.StrategyBuilder.build(a.getDefaultStrategy(d.config),a.Util.extend({},d.config,b))},timeline:this.timeline,activityTimeout:this.config.activity_timeout,pongTimeout:this.config.pong_timeout,unavailableTimeout:this.config.unavailable_timeout},this.config,{encrypted:this.isEncrypted()})),this.connection.bind("connected",function(){d.subscribeAll(),d.timelineSender&&d.timelineSender.send(d.connection.isEncrypted())}),this.connection.bind("message",function(a){var b=0===a.event.indexOf("pusher_internal:");if(a.channel){var c=d.channel(a.channel);c&&c.handleEvent(a.event,a.data)}b||d.global_emitter.emit(a.event,a.data)}),this.connection.bind("disconnected",function(){d.channels.disconnect()}),this.connection.bind("error",function(b){a.warn("Error",b)}),a.instances.push(this),this.timeline.info({instances:a.instances.length}),a.isReady&&d.connect()}var b=a.prototype;a.instances=[],a.isReady=!1,a.debug=function(){a.log&&a.log(a.Util.stringify.apply(this,arguments))},a.warn=function(){var b=a.Util.stringify.apply(this,arguments);window.console&&(window.console.warn?window.console.warn(b):window.console.log&&window.console.log(b)),a.log&&a.log(b)},a.ready=function(){a.isReady=!0;for(var b=0,c=a.instances.length;c>b;b++)a.instances[b].connect()},b.channel=function(a){return this.channels.find(a)},b.allChannels=function(){return this.channels.all()},b.connect=function(){if(this.connection.connect(),this.timelineSender&&!this.timelineSenderTimer){var b=this.connection.isEncrypted(),c=this.timelineSender;this.timelineSenderTimer=new a.PeriodicTimer(6e4,function(){c.send(b)})}},b.disconnect=function(){this.connection.disconnect(),this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)},b.bind=function(a,b){return this.global_emitter.bind(a,b),this},b.bind_all=function(a){return this.global_emitter.bind_all(a),this},b.subscribeAll=function(){for(var a in this.channels.channels)this.channels.channels.hasOwnProperty(a)&&this.subscribe(a)},b.subscribe=function(a){return a=this.channels.add(a,this),"connected"===this.connection.state&&a.subscribe(),a},b.unsubscribe=function(a){a=this.channels.remove(a),"connected"===this.connection.state&&a.unsubscribe()},b.send_event=function(a,b,c){return this.connection.send_event(a,b,c)},b.isEncrypted=function(){return"https:"===a.Util.getDocumentLocation().protocol?!0:Boolean(this.config.encrypted)},this.Pusher=a}).call(this),function(){function a(a,b){var c=this;this.timeout=setTimeout(function(){null!==c.timeout&&(b(),c.timeout=null)},a)}var b=a.prototype;b.isRunning=function(){return null!==this.timeout},b.ensureAborted=function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},Pusher.Timer=a}.call(this),function(){function a(a,b){var c=this;this.interval=setInterval(function(){null!==c.interval&&b()},a)}var b=a.prototype;b.isRunning=function(){return null!==this.interval},b.ensureAborted=function(){this.interval&&(clearInterval(this.interval),this.interval=null)},Pusher.PeriodicTimer=a}.call(this),function(){Pusher.Util={now:function(){return Date.now?Date.now():(new Date).valueOf()},defer:function(a){return new Pusher.Timer(0,a)},extend:function(a){for(var b=1;b<arguments.length;b++){var c,d=arguments[b];for(c in d)a[c]=d[c]&&d[c].constructor&&d[c].constructor===Object?Pusher.Util.extend(a[c]||{},d[c]):d[c]}return a},stringify:function(){for(var a=["Pusher"],b=0;b<arguments.length;b++)"string"==typeof arguments[b]?a.push(arguments[b]):void 0===window.JSON?a.push(arguments[b].toString()):a.push(JSON.stringify(arguments[b]));return a.join(" : ")},arrayIndexOf:function(a,b){var c=Array.prototype.indexOf;if(null===a)return-1;if(c&&a.indexOf===c)return a.indexOf(b);for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1},objectApply:function(a,b){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b(a[c],c,a)},keys:function(a){var b=[];return Pusher.Util.objectApply(a,function(a,c){b.push(c)}),b},values:function(a){var b=[];return Pusher.Util.objectApply(a,function(a){b.push(a)}),b},apply:function(a,b){for(var c=0;c<a.length;c++)b(a[c],c,a)},map:function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(b(a[d],d,a,c));return c},mapObject:function(a,b){var c={};return Pusher.Util.objectApply(a,function(a,d){c[d]=b(a)}),c},filter:function(a,b){for(var b=b||function(a){return!!a},c=[],d=0;d<a.length;d++)b(a[d],d,a,c)&&c.push(a[d]);return c},filterObject:function(a,b){var c={};return Pusher.Util.objectApply(a,function(d,e){(b&&b(d,e,a,c)||Boolean(d))&&(c[e]=d)}),c},flatten:function(a){var b=[];return Pusher.Util.objectApply(a,function(a,c){b.push([c,a])}),b},any:function(a,b){for(var c=0;c<a.length;c++)if(b(a[c],c,a))return!0;return!1},all:function(a,b){for(var c=0;c<a.length;c++)if(!b(a[c],c,a))return!1;return!0},method:function(a){var b=Array.prototype.slice.call(arguments,1);return function(c){return c[a].apply(c,b.concat(arguments))}},getDocument:function(){return document},getDocumentLocation:function(){return Pusher.Util.getDocument().location},getLocalStorage:function(){try{return window.localStorage}catch(a){}},getClientFeatures:function(){return Pusher.Util.keys(Pusher.Util.filterObject({ws:Pusher.WSTransport,flash:Pusher.FlashTransport},function(a){return a.isSupported()}))}}}.call(this),function(){Pusher.VERSION="2.1.5",Pusher.PROTOCOL=7,Pusher.host="ws.pusherapp.com",Pusher.ws_port=80,Pusher.wss_port=443,Pusher.sockjs_host="sockjs.pusher.com",Pusher.sockjs_http_port=80,Pusher.sockjs_https_port=443,Pusher.sockjs_path="/pusher",Pusher.stats_host="stats.pusher.com",Pusher.channel_auth_endpoint="/pusher/auth",Pusher.channel_auth_transport="ajax",Pusher.activity_timeout=12e4,Pusher.pong_timeout=3e4,Pusher.unavailable_timeout=1e4,Pusher.cdn_http="http://js.pusher.com/",Pusher.cdn_https="https://d3dy5gmtp8yhk7.cloudfront.net/",Pusher.dependency_suffix=".min",Pusher.getDefaultStrategy=function(a){return[[":def","ws_options",{hostUnencrypted:a.wsHost+":"+a.wsPort,hostEncrypted:a.wsHost+":"+a.wssPort}],[":def","sockjs_options",{hostUnencrypted:a.httpHost+":"+a.httpPort,hostEncrypted:a.httpHost+":"+a.httpsPort}],[":def","timeouts",{loop:!0,timeout:15e3,timeoutLimit:6e4}],[":def","ws_manager",[":transport_manager",{lives:2,minPingDelay:1e4,maxPingDelay:a.activity_timeout}]],[":def_transport","ws","ws",3,":ws_options",":ws_manager"],[":def_transport","flash","flash",2,":ws_options",":ws_manager"],[":def_transport","sockjs","sockjs",1,":sockjs_options"],[":def","ws_loop",[":sequential",":timeouts",":ws"]],[":def","flash_loop",[":sequential",":timeouts",":flash"]],[":def","sockjs_loop",[":sequential",":timeouts",":sockjs"]],[":def","strategy",[":cached",18e5,[":first_connected",[":if",[":is_supported",":ws"],[":best_connected_ever",":ws_loop",[":delayed",2e3,[":sockjs_loop"]]],[":if",[":is_supported",":flash"],[":best_connected_ever",":flash_loop",[":delayed",2e3,[":sockjs_loop"]]],[":sockjs_loop"]]]]]]]}}.call(this),function(){Pusher.getGlobalConfig=function(){return{wsHost:Pusher.host,wsPort:Pusher.ws_port,wssPort:Pusher.wss_port,httpHost:Pusher.sockjs_host,httpPort:Pusher.sockjs_http_port,httpsPort:Pusher.sockjs_https_port,httpPath:Pusher.sockjs_path,statsHost:Pusher.stats_host,authEndpoint:Pusher.channel_auth_endpoint,authTransport:Pusher.channel_auth_transport,activity_timeout:Pusher.activity_timeout,pong_timeout:Pusher.pong_timeout,unavailable_timeout:Pusher.unavailable_timeout}},Pusher.getClusterConfig=function(a){return{wsHost:"ws-"+a+".pusher.com",httpHost:"sockjs-"+a+".pusher.com"}}}.call(this),function(){function a(a){var b=function(b){Error.call(this,b),this.name=a};return Pusher.Util.extend(b.prototype,Error.prototype),b}Pusher.Errors={BadEventName:a("BadEventName"),UnsupportedTransport:a("UnsupportedTransport"),UnsupportedStrategy:a("UnsupportedStrategy"),TransportPriorityTooLow:a("TransportPriorityTooLow"),TransportClosed:a("TransportClosed")}}.call(this),function(){function a(a){this.callbacks=new b,this.global_callbacks=[],this.failThrough=a}function b(){this._callbacks={}}var c=a.prototype;c.bind=function(a,b){return this.callbacks.add(a,b),this},c.bind_all=function(a){return this.global_callbacks.push(a),this},c.unbind=function(a,b){return this.callbacks.remove(a,b),this},c.emit=function(a,b){var c;for(c=0;c<this.global_callbacks.length;c++)this.global_callbacks[c](a,b);var d=this.callbacks.get(a);if(d&&d.length>0)for(c=0;c<d.length;c++)d[c](b);else this.failThrough&&this.failThrough(a,b);return this},b.prototype.get=function(a){return this._callbacks[this._prefix(a)]},b.prototype.add=function(a,b){var c=this._prefix(a);this._callbacks[c]=this._callbacks[c]||[],this._callbacks[c].push(b)},b.prototype.remove=function(a,b){if(this.get(a)){var c=Pusher.Util.arrayIndexOf(this.get(a),b);if(-1!==c){var d=this._callbacks[this._prefix(a)].slice(0);d.splice(c,1),this._callbacks[this._prefix(a)]=d}}},b.prototype._prefix=function(a){return"_"+a},Pusher.EventsDispatcher=a}.call(this),function(){function a(a){this.options=a,this.loading={},this.loaded={}}function b(a,b){Pusher.Util.getDocument().addEventListener?a.addEventListener("load",b,!1):a.attachEvent("onreadystatechange",function(){("loaded"===a.readyState||"complete"===a.readyState)&&b()})}function c(a,c){var d=Pusher.Util.getDocument(),e=d.getElementsByTagName("head")[0],d=d.createElement("script");d.setAttribute("src",a),d.setAttribute("type","text/javascript"),d.setAttribute("async",!0),b(d,function(){setTimeout(c,0)}),e.appendChild(d)}var d=a.prototype;d.load=function(a,b){var d=this;this.loaded[a]?b():this.loading[a]&&this.loading[a].length>0?this.loading[a].push(b):(this.loading[a]=[b],c(this.getPath(a),function(){if(d.loaded[a]=!0,d.loading[a]){for(var b=0;b<d.loading[a].length;b++)d.loading[a][b]();delete d.loading[a]}}))},d.getRoot=function(a){var b=Pusher.Util.getDocumentLocation().protocol;return(a&&a.encrypted||"https:"===b?this.options.cdn_https:this.options.cdn_http).replace(/\/*$/,"")+"/"+this.options.version},d.getPath=function(a,b){return this.getRoot(b)+"/"+a+this.options.suffix+".js"},Pusher.DependencyLoader=a}.call(this),function(){function a(){Pusher.ready()}function b(a){document.body?a():setTimeout(function(){b(a)},0)}function c(){b(a)}Pusher.Dependencies=new Pusher.DependencyLoader({cdn_http:Pusher.cdn_http,cdn_https:Pusher.cdn_https,version:Pusher.VERSION,suffix:Pusher.dependency_suffix}),!window.WebSocket&&window.MozWebSocket&&(window.WebSocket=window.MozWebSocket),window.JSON?c():Pusher.Dependencies.load("json2",c)}(),function(){for(var a=String.fromCharCode,b=0;64>b;b++)"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(b);var c=function(b){var c=b.charCodeAt(0);return 128>c?b:2048>c?a(192|c>>>6)+a(128|63&c):a(224|c>>>12&15)+a(128|c>>>6&63)+a(128|63&c)},d=function(a){var b=[0,2,1][a.length%3],a=a.charCodeAt(0)<<16|(a.length>1?a.charCodeAt(1):0)<<8|(a.length>2?a.charCodeAt(2):0);return["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>18),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>12&63),b>=2?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>6&63),b>=1?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&a)].join("")},e=window.btoa||function(a){return a.replace(/[\s\S]{1,3}/g,d)};Pusher.Base64={encode:function(a){return e(a.replace(/[^\x00-\x7F]/g,c))}}}.call(this),function(){function a(a){this.options=a}function b(a){return Pusher.Util.mapObject(a,function(a){return"object"==typeof a&&(a=JSON.stringify(a)),encodeURIComponent(Pusher.Base64.encode(a.toString()))})}a.send=function(a,b){var c=new Pusher.JSONPRequest({url:a.url,receiver:a.receiverName,tagPrefix:a.tagPrefix}),d=a.receiver.register(function(a,d){c.cleanup(),b(a,d)});return c.send(d,a.data,function(b){var c=a.receiver.unregister(d);c&&c(b)})};var c=a.prototype;c.send=function(a,c,d){if(this.script)return!1;var e=this.options.tagPrefix||"_pusher_jsonp_",c=Pusher.Util.extend({},c,{receiver:this.options.receiver}),c=Pusher.Util.map(Pusher.Util.flatten(b(Pusher.Util.filterObject(c,function(a){return void 0!==a}))),Pusher.Util.method("join","=")).join("&");this.script=document.createElement("script"),this.script.id=e+a,this.script.src=this.options.url+"/"+a+"?"+c,this.script.type="text/javascript",this.script.charset="UTF-8",this.script.onerror=this.script.onload=d,void 0===this.script.async&&document.attachEvent&&/opera/i.test(navigator.userAgent)&&(e=this.options.receiver||"Pusher.JSONP.receive",this.errorScript=document.createElement("script"),this.errorScript.text=e+"("+a+", true);",this.script.async=this.errorScript.async=!1);var f=this;return this.script.onreadystatechange=function(){f.script&&/loaded|complete/.test(f.script.readyState)&&d(!0)},a=document.getElementsByTagName("head")[0],a.insertBefore(this.script,a.firstChild),this.errorScript&&a.insertBefore(this.errorScript,this.script.nextSibling),!0},c.cleanup=function(){this.script&&this.script.parentNode&&(this.script.parentNode.removeChild(this.script),this.script=null),this.errorScript&&this.errorScript.parentNode&&(this.errorScript.parentNode.removeChild(this.errorScript),this.errorScript=null)},Pusher.JSONPRequest=a}.call(this),function(){function a(){this.lastId=0,this.callbacks={}}var b=a.prototype;b.register=function(a){this.lastId++;var b=this.lastId;return this.callbacks[b]=a,b},b.unregister=function(a){if(this.callbacks[a]){var b=this.callbacks[a];return delete this.callbacks[a],b}return null},b.receive=function(a,b,c){(a=this.unregister(a))&&a(b,c)},Pusher.JSONPReceiver=a,Pusher.JSONP=new a}.call(this),function(){function a(a,b,c){this.key=a,this.session=b,this.events=[],this.options=c||{},this.uniqueID=this.sent=0}var b=a.prototype;a.ERROR=3,a.INFO=6,a.DEBUG=7,b.log=function(b,c){(void 0===this.options.level||b<=this.options.level)&&(this.events.push(Pusher.Util.extend({},c,{timestamp:Pusher.Util.now(),level:b!==a.INFO?b:void 0})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())},b.error=function(b){this.log(a.ERROR,b)},b.info=function(b){this.log(a.INFO,b)},b.debug=function(b){this.log(a.DEBUG,b)},b.isEmpty=function(){return 0===this.events.length},b.send=function(a,b){var c=this,d=Pusher.Util.extend({session:c.session,bundle:c.sent+1,key:c.key,lib:"js",version:c.options.version,features:c.options.features,timeline:c.events},c.options.params);return c.events=[],a(d,function(a,d){a||c.sent++,b&&b(a,d)}),!0},b.generateUniqueID=function(){return this.uniqueID++,this.uniqueID},Pusher.Timeline=a}.call(this),function(){function a(a,b){this.timeline=a,this.options=b||{}}a.prototype.send=function(a,b){if(!this.timeline.isEmpty()){var c=this,d="http"+(a?"s":"")+"://";c.timeline.send(function(a,b){var e={data:Pusher.Util.filterObject(a,function(a){return void 0!==a}),url:d+(c.host||c.options.host)+c.options.path,receiver:Pusher.JSONP};return Pusher.JSONPRequest.send(e,function(a,d){d&&d.host&&(c.host=d.host),b&&b(a,d)})},b)}},Pusher.TimelineSender=a}.call(this),function(){function a(a){this.strategies=a}function b(a,b,c){var e=Pusher.Util.map(a,function(a,d,e,f){return a.connect(b,c(d,f))});return{abort:function(){Pusher.Util.apply(e,d)},forceMinPriority:function(a){Pusher.Util.apply(e,function(b){b.forceMinPriority(a)})}}}function c(a){return Pusher.Util.all(a,function(a){return Boolean(a.error)})}function d(a){a.error||a.aborted||(a.abort(),a.aborted=!0)}var e=a.prototype;e.isSupported=function(){return Pusher.Util.any(this.strategies,Pusher.Util.method("isSupported"))},e.connect=function(a,d){return b(this.strategies,a,function(a,b){return function(e,f){(b[a].error=e)?c(b)&&d(!0):(Pusher.Util.apply(b,function(a){a.forceMinPriority(f.transport.priority)}),d(null,f))}})},Pusher.BestConnectedEverStrategy=a}.call(this),function(){function a(a,b,c){this.strategy=a,this.transports=b,this.ttl=c.ttl||18e5,this.encrypted=c.encrypted,this.timeline=c.timeline}function b(a){return"pusherTransport"+(a?"Encrypted":"Unencrypted")}function c(a){var c=Pusher.Util.getLocalStorage();if(c)try{var e=c[b(a)];if(e)return JSON.parse(e)}catch(f){d(a)}return null}function d(a){var c=Pusher.Util.getLocalStorage();if(c)try{delete c[b(a)]}catch(d){}}var e=a.prototype;e.isSupported=function(){return this.strategy.isSupported()},e.connect=function(a,e){var f=this.encrypted,g=c(f),h=[this.strategy];if(g&&g.timestamp+this.ttl>=Pusher.Util.now()){var i=this.transports[g.transport];i&&(this.timeline.info({cached:!0,transport:g.transport}),h.push(new Pusher.SequentialStrategy([i],{timeout:2*g.latency,failFast:!0})))}var j=Pusher.Util.now(),k=h.pop().connect(a,function l(c,g){if(c)d(f),h.length>0?(j=Pusher.Util.now(),k=h.pop().connect(a,l)):e(c);else{var i=g.transport.name,m=Pusher.Util.now()-j,n=Pusher.Util.getLocalStorage();if(n)try{n[b(f)]=JSON.stringify({timestamp:Pusher.Util.now(),transport:i,latency:m})}catch(o){}e(null,g)}});return{abort:function(){k.abort()},forceMinPriority:function(b){a=b,k&&k.forceMinPriority(b)}}},Pusher.CachedStrategy=a}.call(this),function(){function a(a,b){this.strategy=a,this.options={delay:b.delay}}var b=a.prototype;b.isSupported=function(){return this.strategy.isSupported()},b.connect=function(a,b){var c,d=this.strategy,e=new Pusher.Timer(this.options.delay,function(){c=d.connect(a,b)});return{abort:function(){e.ensureAborted(),c&&c.abort()},forceMinPriority:function(b){a=b,c&&c.forceMinPriority(b)}}},Pusher.DelayedStrategy=a}.call(this),function(){function a(a){this.strategy=a}var b=a.prototype;b.isSupported=function(){return this.strategy.isSupported()},b.connect=function(a,b){var c=this.strategy.connect(a,function(a,d){d&&c.abort(),b(a,d)});return c},Pusher.FirstConnectedStrategy=a}.call(this),function(){function a(a,b,c){this.test=a,this.trueBranch=b,this.falseBranch=c}var b=a.prototype;b.isSupported=function(){return(this.test()?this.trueBranch:this.falseBranch).isSupported()},b.connect=function(a,b){return(this.test()?this.trueBranch:this.falseBranch).connect(a,b)},Pusher.IfStrategy=a}.call(this),function(){function a(a,b){this.strategies=a,this.loop=Boolean(b.loop),this.failFast=Boolean(b.failFast),this.timeout=b.timeout,this.timeoutLimit=b.timeoutLimit}var b=a.prototype;b.isSupported=function(){return Pusher.Util.any(this.strategies,Pusher.Util.method("isSupported"))},b.connect=function(a,b){var c=this,d=this.strategies,e=0,f=this.timeout,g=null,h=function(i,j){j?b(null,j):(e+=1,c.loop&&(e%=d.length),e<d.length?(f&&(f*=2,c.timeoutLimit&&(f=Math.min(f,c.timeoutLimit))),g=c.tryStrategy(d[e],a,{timeout:f,failFast:c.failFast},h)):b(!0))},g=this.tryStrategy(d[e],a,{timeout:f,failFast:this.failFast},h);return{abort:function(){g.abort()},forceMinPriority:function(b){a=b,g&&g.forceMinPriority(b)}}},b.tryStrategy=function(a,b,c,d){var e=null,f=null;return c.timeout>0&&(e=new Pusher.Timer(c.timeout,function(){f.abort(),d(!0)})),f=a.connect(b,function(a,b){a&&e&&e.isRunning()&&!c.failFast||(e&&e.ensureAborted(),d(a,b))}),{abort:function(){e&&e.ensureAborted(),f.abort()},forceMinPriority:function(a){f.forceMinPriority(a)}}},Pusher.SequentialStrategy=a}.call(this),function(){function a(a,b,c,d){this.name=a,this.priority=b,this.transport=c,this.options=d||{}}function b(a,b){return Pusher.Util.defer(function(){b(a)}),{abort:function(){},forceMinPriority:function(){}}}var c=a.prototype;c.isSupported=function(){return this.transport.isSupported()},c.connect=function(a,c){if(!this.isSupported())return b(new Pusher.Errors.UnsupportedStrategy,c);if(this.priority<a)return b(new Pusher.Errors.TransportPriorityTooLow,c);var d=this,e=!1,f=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),g=null,h=function(){f.unbind("initialized",h),f.connect()},i=function(){g=new Pusher.Handshake(f,function(a){e=!0,l(),c(null,a)})},j=function(a){l(),c(a)},k=function(){l(),c(new Pusher.Errors.TransportClosed(f))},l=function(){f.unbind("initialized",h),f.unbind("open",i),f.unbind("error",j),f.unbind("closed",k)};return f.bind("initialized",h),f.bind("open",i),f.bind("error",j),f.bind("closed",k),f.initialize(),{abort:function(){e||(l(),g?g.close():f.close())},forceMinPriority:function(a){e||d.priority<a&&(g?g.close():f.close())}}},Pusher.TransportStrategy=a}.call(this),function(){function a(a,b,c,d){Pusher.EventsDispatcher.call(this),this.name=a,this.priority=b,this.key=c,this.state="new",this.timeline=d.timeline,this.activityTimeout=d.activityTimeout,this.id=this.timeline.generateUniqueID(),this.options={encrypted:Boolean(d.encrypted),hostUnencrypted:d.hostUnencrypted,hostEncrypted:d.hostEncrypted}}var b=a.prototype;Pusher.Util.extend(b,Pusher.EventsDispatcher.prototype),a.isSupported=function(){return!1},b.supportsPing=function(){return!1},b.initialize=function(){this.timeline.info(this.buildTimelineMessage({transport:this.name+(this.options.encrypted?"s":"")})),this.timeline.debug(this.buildTimelineMessage({method:"initialize"})),this.changeState("initialized")},b.connect=function(){var a=this.getURL(this.key,this.options);if(this.timeline.debug(this.buildTimelineMessage({method:"connect",url:a})),this.socket||"initialized"!==this.state)return!1;try{this.socket=this.createSocket(a)}catch(b){var c=this;return Pusher.Util.defer(function(){c.onError(b),c.changeState("closed")}),!1}return this.bindListeners(),Pusher.debug("Connecting",{transport:this.name,url:a}),this.changeState("connecting"),!0},b.close=function(){return this.timeline.debug(this.buildTimelineMessage({method:"close"})),this.socket?(this.socket.close(),!0):!1},b.send=function(a){if(this.timeline.debug(this.buildTimelineMessage({method:"send",data:a})),"open"===this.state){var b=this;return setTimeout(function(){b.socket&&b.socket.send(a)},0),!0}return!1},b.onOpen=function(){this.changeState("open"),this.socket.onopen=void 0},b.onError=function(a){this.emit("error",{type:"WebSocketError",error:a}),this.timeline.error(this.buildTimelineMessage({}))},b.onClose=function(a){a?this.changeState("closed",{code:a.code,reason:a.reason,wasClean:a.wasClean}):this.changeState("closed"),this.socket=void 0},b.onMessage=function(a){this.timeline.debug(this.buildTimelineMessage({message:a.data})),this.emit("message",a)},b.bindListeners=function(){var a=this;this.socket.onopen=function(){a.onOpen()},this.socket.onerror=function(b){a.onError(b)},this.socket.onclose=function(b){a.onClose(b)},this.socket.onmessage=function(b){a.onMessage(b)}},b.createSocket=function(){return null},b.getScheme=function(){return this.options.encrypted?"wss":"ws"},b.getBaseURL=function(){var a;return a=this.options.encrypted?this.options.hostEncrypted:this.options.hostUnencrypted,this.getScheme()+"://"+a},b.getPath=function(){return"/app/"+this.key},b.getQueryString=function(){return"?protocol="+Pusher.PROTOCOL+"&client=js&version="+Pusher.VERSION},b.getURL=function(){return this.getBaseURL()+this.getPath()+this.getQueryString()},b.changeState=function(a,b){this.state=a,this.timeline.info(this.buildTimelineMessage({state:a,params:b})),this.emit(a,b)},b.buildTimelineMessage=function(a){return Pusher.Util.extend({cid:this.id},a)},Pusher.AbstractTransport=a}.call(this),function(){function a(a,b,c,d){Pusher.AbstractTransport.call(this,a,b,c,d)}var b=a.prototype;Pusher.Util.extend(b,Pusher.AbstractTransport.prototype),a.createConnection=function(b,c,d,e){return new a(b,c,d,e)},a.isSupported=function(){try{return Boolean(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))}catch(a){try{return Boolean(navigator&&navigator.mimeTypes&&void 0!==navigator.mimeTypes["application/x-shockwave-flash"])}catch(b){return!1}}},b.initialize=function(){var a=this;this.timeline.info(this.buildTimelineMessage({transport:this.name+(this.options.encrypted?"s":"")})),this.timeline.debug(this.buildTimelineMessage({method:"initialize"})),this.changeState("initializing"),void 0===window.WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR&&(window.WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR=!0),window.WEB_SOCKET_SWF_LOCATION=Pusher.Dependencies.getRoot()+"/WebSocketMain.swf",Pusher.Dependencies.load("flashfallback",function(){a.changeState("initialized")})},b.createSocket=function(a){return new FlashWebSocket(a)},b.getQueryString=function(){return Pusher.AbstractTransport.prototype.getQueryString.call(this)+"&flash=true"},Pusher.FlashTransport=a}.call(this),function(){function a(a,b,c,d){Pusher.AbstractTransport.call(this,a,b,c,d),this.options.ignoreNullOrigin=d.ignoreNullOrigin}var b=a.prototype;Pusher.Util.extend(b,Pusher.AbstractTransport.prototype),a.createConnection=function(b,c,d,e){return new a(b,c,d,e)},a.isSupported=function(){return!0},b.initialize=function(){var a=this;this.timeline.info(this.buildTimelineMessage({transport:this.name+(this.options.encrypted?"s":"")})),this.timeline.debug(this.buildTimelineMessage({method:"initialize"})),this.changeState("initializing"),Pusher.Dependencies.load("sockjs",function(){a.changeState("initialized")})},b.supportsPing=function(){return!0},b.createSocket=function(a){return new SockJS(a,null,{js_path:Pusher.Dependencies.getPath("sockjs",{encrypted:this.options.encrypted}),ignore_null_origin:this.options.ignoreNullOrigin})},b.getScheme=function(){return this.options.encrypted?"https":"http"},b.getPath=function(){return this.options.httpPath||"/pusher"},b.getQueryString=function(){return""},b.onOpen=function(){this.socket.send(JSON.stringify({path:Pusher.AbstractTransport.prototype.getPath.call(this)+Pusher.AbstractTransport.prototype.getQueryString.call(this)})),this.changeState("open"),this.socket.onopen=void 0},Pusher.SockJSTransport=a}.call(this),function(){function a(a,b,c,d){Pusher.AbstractTransport.call(this,a,b,c,d)}var b=a.prototype;Pusher.Util.extend(b,Pusher.AbstractTransport.prototype),a.createConnection=function(b,c,d,e){return new a(b,c,d,e)},a.isSupported=function(){return void 0!==window.WebSocket||void 0!==window.MozWebSocket},b.createSocket=function(a){return new(window.WebSocket||window.MozWebSocket)(a)},b.getQueryString=function(){return Pusher.AbstractTransport.prototype.getQueryString.call(this)+"&flash=false"},Pusher.WSTransport=a}.call(this),function(){function a(a,b,c){this.manager=a,this.transport=b,this.minPingDelay=c.minPingDelay,this.maxPingDelay=c.maxPingDelay,this.pingDelay=void 0}var b=a.prototype;b.createConnection=function(a,b,c,d){var e=this,d=Pusher.Util.extend({},d,{activityTimeout:e.pingDelay}),f=e.transport.createConnection(a,b,c,d),g=null,h=function(){f.unbind("open",h),f.bind("closed",i),g=Pusher.Util.now()},i=function(a){f.unbind("closed",i),1002===a.code||1003===a.code?e.manager.reportDeath():!a.wasClean&&g&&(a=Pusher.Util.now()-g,a<2*e.maxPingDelay)&&(e.manager.reportDeath(),e.pingDelay=Math.max(a/2,e.minPingDelay))};return f.bind("open",h),f},b.isSupported=function(){return this.manager.isAlive()&&this.transport.isSupported()},Pusher.AssistantToTheTransportManager=a}.call(this),function(){function a(a){this.options=a||{},this.livesLeft=this.options.lives||1/0}var b=a.prototype;b.getAssistant=function(a){return new Pusher.AssistantToTheTransportManager(this,a,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})},b.isAlive=function(){return this.livesLeft>0},b.reportDeath=function(){this.livesLeft-=1},Pusher.TransportManager=a}.call(this),function(){function a(a){return function(b){return[a.apply(this,arguments),b]}}function b(a,c){if(0===a.length)return[[],c];var e=d(a[0],c),f=b(a.slice(1),e[1]);return[[e[0]].concat(f[0]),f[1]]}function c(a,c){if("string"==typeof a[0]&&":"===a[0].charAt(0)){var e=c[a[0].slice(1)];if(a.length>1){if("function"!=typeof e)throw"Calling non-function "+a[0];var f=[Pusher.Util.extend({},c)].concat(Pusher.Util.map(a.slice(1),function(a){return d(a,Pusher.Util.extend({},c))[0]}));return e.apply(this,f)}return[e,c]}return b(a,c)}function d(a,b){if("string"==typeof a){var d;if("string"==typeof a&&":"===a.charAt(0)){if(d=b[a.slice(1)],void 0===d)throw"Undefined symbol "+a;d=[d,b]}else d=[a,b];return d}return"object"==typeof a&&a instanceof Array&&a.length>0?c(a,b):[a,b]}var e={ws:Pusher.WSTransport,flash:Pusher.FlashTransport,sockjs:Pusher.SockJSTransport},f={isSupported:function(){return!1},connect:function(a,b){var c=Pusher.Util.defer(function(){b(new Pusher.Errors.UnsupportedStrategy)});return{abort:function(){c.ensureAborted()},forceMinPriority:function(){}}}},g={def:function(a,b,c){if(void 0!==a[b])throw"Redefining symbol "+b;return a[b]=c,[void 0,a]},def_transport:function(a,b,c,d,g,h){var i=e[c];if(!i)throw new Pusher.Errors.UnsupportedTransport(c);return c=a.enabledTransports&&-1===Pusher.Util.arrayIndexOf(a.enabledTransports,b)||a.disabledTransports&&-1!==Pusher.Util.arrayIndexOf(a.disabledTransports,b)||"flash"===b&&a.disableFlash===!0?f:new Pusher.TransportStrategy(b,d,h?h.getAssistant(i):i,Pusher.Util.extend({key:a.key,encrypted:a.encrypted,timeline:a.timeline,ignoreNullOrigin:a.ignoreNullOrigin},g)),d=a.def(a,b,c)[1],d.transports=a.transports||{},d.transports[b]=c,[void 0,d]},transport_manager:a(function(a,b){return new Pusher.TransportManager(b)}),sequential:a(function(a,b){var c=Array.prototype.slice.call(arguments,2);return new Pusher.SequentialStrategy(c,b)}),cached:a(function(a,b,c){return new Pusher.CachedStrategy(c,a.transports,{ttl:b,timeline:a.timeline})}),first_connected:a(function(a,b){return new Pusher.FirstConnectedStrategy(b)}),best_connected_ever:a(function(){var a=Array.prototype.slice.call(arguments,1);return new Pusher.BestConnectedEverStrategy(a)}),delayed:a(function(a,b,c){return new Pusher.DelayedStrategy(c,{delay:b})}),"if":a(function(a,b,c,d){return new Pusher.IfStrategy(b,c,d)}),is_supported:a(function(a,b){return function(){return b.isSupported()}})};Pusher.StrategyBuilder={build:function(a,b){var c=Pusher.Util.extend({},g,b);return d(a,c)[1].strategy}}}.call(this),function(){Pusher.Protocol={decodeMessage:function(a){try{var b=JSON.parse(a.data);if("string"==typeof b.data)try{b.data=JSON.parse(b.data)}catch(c){if(!(c instanceof SyntaxError))throw c}return b}catch(d){throw{type:"MessageParseError",error:d,data:a.data}}},encodeMessage:function(a){return JSON.stringify(a)},processHandshake:function(a){if(a=this.decodeMessage(a),"pusher:connection_established"===a.event)return{action:"connected",id:a.data.socket_id,activityTimeout:1e3*a.data.activity_timeout};if("pusher:error"===a.event)return{action:this.getCloseAction(a.data),error:this.getCloseError(a.data)};throw"Invalid handshake"},getCloseAction:function(a){return a.code<4e3?a.code>=1002&&a.code<=1004?"backoff":null:4e3===a.code?"ssl_only":a.code<4100?"refused":a.code<4200?"backoff":a.code<4300?"retry":"refused"},getCloseError:function(a){return 1e3!==a.code&&1001!==a.code?{type:"PusherError",data:{code:a.code,message:a.reason||a.message}}:null}}}.call(this),function(){function a(a,b){Pusher.EventsDispatcher.call(this),this.id=a,this.transport=b,this.activityTimeout=b.activityTimeout,this.bindListeners()}var b=a.prototype;Pusher.Util.extend(b,Pusher.EventsDispatcher.prototype),b.supportsPing=function(){return this.transport.supportsPing()},b.send=function(a){return this.transport.send(a)},b.send_event=function(a,b,c){return a={event:a,data:b},c&&(a.channel=c),Pusher.debug("Event sent",a),this.send(Pusher.Protocol.encodeMessage(a))},b.close=function(){this.transport.close()
},b.bindListeners=function(){var a=this,b=function(b){var c;try{c=Pusher.Protocol.decodeMessage(b)}catch(d){a.emit("error",{type:"MessageParseError",error:d,data:b.data})}if(void 0!==c){switch(Pusher.debug("Event recd",c),c.event){case"pusher:error":a.emit("error",{type:"PusherError",data:c.data});break;case"pusher:ping":a.emit("ping");break;case"pusher:pong":a.emit("pong")}a.emit("message",c)}},c=function(b){a.emit("error",{type:"WebSocketError",error:b})},d=function(e){a.transport.unbind("closed",d),a.transport.unbind("error",c),a.transport.unbind("message",b),e&&e.code&&a.handleCloseEvent(e),a.transport=null,a.emit("closed")};a.transport.bind("message",b),a.transport.bind("error",c),a.transport.bind("closed",d)},b.handleCloseEvent=function(a){var b=Pusher.Protocol.getCloseAction(a);(a=Pusher.Protocol.getCloseError(a))&&this.emit("error",a),b&&this.emit(b)},Pusher.Connection=a}.call(this),function(){function a(a,b){this.transport=a,this.callback=b,this.bindListeners()}var b=a.prototype;b.close=function(){this.unbindListeners(),this.transport.close()},b.bindListeners=function(){var a=this;a.onMessage=function(b){a.unbindListeners();try{var c=Pusher.Protocol.processHandshake(b);"connected"===c.action?a.finish("connected",{connection:new Pusher.Connection(c.id,a.transport),activityTimeout:c.activityTimeout}):(a.finish(c.action,{error:c.error}),a.transport.close())}catch(d){a.finish("error",{error:d}),a.transport.close()}},a.onClosed=function(b){a.unbindListeners();var c=Pusher.Protocol.getCloseAction(b)||"backoff",b=Pusher.Protocol.getCloseError(b);a.finish(c,{error:b})},a.transport.bind("message",a.onMessage),a.transport.bind("closed",a.onClosed)},b.unbindListeners=function(){this.transport.unbind("message",this.onMessage),this.transport.unbind("closed",this.onClosed)},b.finish=function(a,b){this.callback(Pusher.Util.extend({transport:this.transport,action:a},b))},Pusher.Handshake=a}.call(this),function(){function a(a,b){Pusher.EventsDispatcher.call(this),this.key=a,this.options=b||{},this.state="initialized",this.connection=null,this.encrypted=!!b.encrypted,this.timeline=this.options.timeline,this.connectionCallbacks=this.buildConnectionCallbacks(),this.errorCallbacks=this.buildErrorCallbacks(),this.handshakeCallbacks=this.buildHandshakeCallbacks(this.errorCallbacks);var c=this;Pusher.Network.bind("online",function(){c.timeline.info({netinfo:"online"}),("connecting"===c.state||"unavailable"===c.state)&&c.retryIn(0)}),Pusher.Network.bind("offline",function(){c.timeline.info({netinfo:"offline"})}),this.updateStrategy()}var b=a.prototype;Pusher.Util.extend(b,Pusher.EventsDispatcher.prototype),b.connect=function(){!this.connection&&!this.runner&&(this.strategy.isSupported()?(this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()):this.updateState("failed"))},b.send=function(a){return this.connection?this.connection.send(a):!1},b.send_event=function(a,b,c){return this.connection?this.connection.send_event(a,b,c):!1},b.disconnect=function(){this.disconnectInternally(),this.updateState("disconnected")},b.isEncrypted=function(){return this.encrypted},b.startConnecting=function(){var a=this,b=function(c,d){c?a.runner=a.strategy.connect(0,b):"error"===d.action?a.timeline.error({handshakeError:d.error}):(a.abortConnecting(),a.handshakeCallbacks[d.action](d))};a.runner=a.strategy.connect(0,b)},b.abortConnecting=function(){this.runner&&(this.runner.abort(),this.runner=null)},b.disconnectInternally=function(){this.abortConnecting(),this.clearRetryTimer(),this.clearUnavailableTimer(),this.stopActivityCheck(),this.connection&&this.abandonConnection().close()},b.updateStrategy=function(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,encrypted:this.encrypted})},b.retryIn=function(a){var b=this;b.timeline.info({action:"retry",delay:a}),a>0&&b.emit("connecting_in",Math.round(a/1e3)),b.retryTimer=new Pusher.Timer(a||0,function(){b.disconnectInternally(),b.connect()})},b.clearRetryTimer=function(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)},b.setUnavailableTimer=function(){var a=this;a.unavailableTimer=new Pusher.Timer(a.options.unavailableTimeout,function(){a.updateState("unavailable")})},b.clearUnavailableTimer=function(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()},b.resetActivityCheck=function(){if(this.stopActivityCheck(),!this.connection.supportsPing()){var a=this;a.activityTimer=new Pusher.Timer(a.activityTimeout,function(){a.send_event("pusher:ping",{}),a.activityTimer=new Pusher.Timer(a.options.pongTimeout,function(){a.timeline.error({pong_timed_out:a.options.pongTimeout}),a.retryIn(0)})})}},b.stopActivityCheck=function(){this.activityTimer&&this.activityTimer.ensureAborted()},b.buildConnectionCallbacks=function(){var a=this;return{message:function(b){a.resetActivityCheck(),a.emit("message",b)},ping:function(){a.send_event("pusher:pong",{})},error:function(b){a.emit("error",{type:"WebSocketError",error:b})},closed:function(){a.abandonConnection(),a.shouldRetry()&&a.retryIn(1e3)}}},b.buildHandshakeCallbacks=function(a){var b=this;return Pusher.Util.extend({},a,{connected:function(a){b.activityTimeout=Math.min(b.options.activityTimeout,a.activityTimeout,a.connection.activityTimeout||1/0),b.clearUnavailableTimer(),b.setConnection(a.connection),b.socket_id=b.connection.id,b.updateState("connected",{socket_id:b.socket_id})}})},b.buildErrorCallbacks=function(){function a(a){return function(c){c.error&&b.emit("error",{type:"WebSocketError",error:c.error}),a(c)}}var b=this;return{ssl_only:a(function(){b.encrypted=!0,b.updateStrategy(),b.retryIn(0)}),refused:a(function(){b.disconnect()}),backoff:a(function(){b.retryIn(1e3)}),retry:a(function(){b.retryIn(0)})}},b.setConnection=function(a){this.connection=a;for(var b in this.connectionCallbacks)this.connection.bind(b,this.connectionCallbacks[b]);this.resetActivityCheck()},b.abandonConnection=function(){if(this.connection){for(var a in this.connectionCallbacks)this.connection.unbind(a,this.connectionCallbacks[a]);return a=this.connection,this.connection=null,a}},b.updateState=function(a,b){var c=this.state;this.state=a,c!==a&&(Pusher.debug("State changed",c+" -> "+a),this.timeline.info({state:a,params:b}),this.emit("state_change",{previous:c,current:a}),this.emit(a,b))},b.shouldRetry=function(){return"connecting"===this.state||"connected"===this.state},Pusher.ConnectionManager=a}.call(this),function(){function a(){Pusher.EventsDispatcher.call(this);var a=this;void 0!==window.addEventListener&&(window.addEventListener("online",function(){a.emit("online")},!1),window.addEventListener("offline",function(){a.emit("offline")},!1))}Pusher.Util.extend(a.prototype,Pusher.EventsDispatcher.prototype),a.prototype.isOnline=function(){return void 0===window.navigator.onLine?!0:window.navigator.onLine},Pusher.NetInfo=a,Pusher.Network=new a}.call(this),function(){function a(){this.reset()}var b=a.prototype;b.get=function(a){return Object.prototype.hasOwnProperty.call(this.members,a)?{id:a,info:this.members[a]}:null},b.each=function(a){var b=this;Pusher.Util.objectApply(b.members,function(c,d){a(b.get(d))})},b.setMyID=function(a){this.myID=a},b.onSubscription=function(a){this.members=a.presence.hash,this.count=a.presence.count,this.me=this.get(this.myID)},b.addMember=function(a){return null===this.get(a.user_id)&&this.count++,this.members[a.user_id]=a.user_info,this.get(a.user_id)},b.removeMember=function(a){var b=this.get(a.user_id);return b&&(delete this.members[a.user_id],this.count--),b},b.reset=function(){this.members={},this.count=0,this.me=this.myID=null},Pusher.Members=a}.call(this),function(){function a(a,b){Pusher.EventsDispatcher.call(this,function(b){Pusher.debug("No callbacks on "+a+" for "+b)}),this.name=a,this.pusher=b,this.subscribed=!1}var b=a.prototype;Pusher.Util.extend(b,Pusher.EventsDispatcher.prototype),b.authorize=function(a,b){return b(!1,{})},b.trigger=function(a,b){if(0!==a.indexOf("client-"))throw new Pusher.Errors.BadEventName("Event '"+a+"' does not start with 'client-'");return this.pusher.send_event(a,b,this.name)},b.disconnect=function(){this.subscribed=!1},b.handleEvent=function(a,b){0===a.indexOf("pusher_internal:")?"pusher_internal:subscription_succeeded"===a&&(this.subscribed=!0,this.emit("pusher:subscription_succeeded",b)):this.emit(a,b)},b.subscribe=function(){var a=this;a.authorize(a.pusher.connection.socket_id,function(b,c){b?a.handleEvent("pusher:subscription_error",c):a.pusher.send_event("pusher:subscribe",{auth:c.auth,channel_data:c.channel_data,channel:a.name})})},b.unsubscribe=function(){this.pusher.send_event("pusher:unsubscribe",{channel:this.name})},Pusher.Channel=a}.call(this),function(){function a(a,b){Pusher.Channel.call(this,a,b)}var b=a.prototype;Pusher.Util.extend(b,Pusher.Channel.prototype),b.authorize=function(a,b){return new Pusher.Channel.Authorizer(this,this.pusher.config).authorize(a,b)},Pusher.PrivateChannel=a}.call(this),function(){function a(a,b){Pusher.PrivateChannel.call(this,a,b),this.members=new Pusher.Members}var b=a.prototype;Pusher.Util.extend(b,Pusher.PrivateChannel.prototype),b.authorize=function(a,b){var c=this;Pusher.PrivateChannel.prototype.authorize.call(c,a,function(a,d){if(!a){if(void 0===d.channel_data)return Pusher.warn("Invalid auth response for channel '"+c.name+"', expected 'channel_data' field"),b("Invalid auth response"),void 0;var e=JSON.parse(d.channel_data);c.members.setMyID(e.user_id)}b(a,d)})},b.handleEvent=function(a,b){switch(a){case"pusher_internal:subscription_succeeded":this.members.onSubscription(b),this.subscribed=!0,this.emit("pusher:subscription_succeeded",this.members);break;case"pusher_internal:member_added":this.emit("pusher:member_added",this.members.addMember(b));break;case"pusher_internal:member_removed":var c=this.members.removeMember(b);c&&this.emit("pusher:member_removed",c);break;default:Pusher.PrivateChannel.prototype.handleEvent.call(this,a,b)}},b.disconnect=function(){this.members.reset(),Pusher.PrivateChannel.prototype.disconnect.call(this)},Pusher.PresenceChannel=a}.call(this),function(){function a(){this.channels={}}var b=a.prototype;b.add=function(a,b){return this.channels[a]||(this.channels[a]=0===a.indexOf("private-")?new Pusher.PrivateChannel(a,b):0===a.indexOf("presence-")?new Pusher.PresenceChannel(a,b):new Pusher.Channel(a,b)),this.channels[a]},b.all=function(){return Pusher.Util.values(this.channels)},b.find=function(a){return this.channels[a]},b.remove=function(a){var b=this.channels[a];return delete this.channels[a],b},b.disconnect=function(){Pusher.Util.objectApply(this.channels,function(a){a.disconnect()})},Pusher.Channels=a}.call(this),function(){Pusher.Channel.Authorizer=function(a,b){this.channel=a,this.type=b.authTransport,this.options=b,this.authOptions=(b||{}).auth||{}},Pusher.Channel.Authorizer.prototype={composeQuery:function(a){var b,a="&socket_id="+encodeURIComponent(a)+"&channel_name="+encodeURIComponent(this.channel.name);for(b in this.authOptions.params)a+="&"+encodeURIComponent(b)+"="+encodeURIComponent(this.authOptions.params[b]);return a},authorize:function(a,b){return Pusher.authorizers[this.type].call(this,a,b)}};var a=1;Pusher.auth_callbacks={},Pusher.authorizers={ajax:function(a,b){var c;c=Pusher.XHR?new Pusher.XHR:window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),c.open("POST",this.options.authEndpoint,!0),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(var d in this.authOptions.headers)c.setRequestHeader(d,this.authOptions.headers[d]);return c.onreadystatechange=function(){if(4==c.readyState)if(200==c.status){var a,d=!1;try{a=JSON.parse(c.responseText),d=!0}catch(e){b(!0,"JSON returned from webapp was invalid, yet status code was 200. Data was: "+c.responseText)}d&&b(!1,a)}else Pusher.warn("Couldn't get auth info from your webapp",c.status),b(!0,c.status)},c.send(this.composeQuery(a)),c},jsonp:function(b,c){void 0!==this.authOptions.headers&&Pusher.warn("Warn","To send headers with the auth request, you must use AJAX, rather than JSONP.");var d=a.toString();a++;var e=Pusher.Util.getDocument(),f=e.createElement("script");Pusher.auth_callbacks[d]=function(a){c(!1,a)},f.src=this.options.authEndpoint+"?callback="+encodeURIComponent("Pusher.auth_callbacks['"+d+"']")+this.composeQuery(b),d=e.getElementsByTagName("head")[0]||e.documentElement,d.insertBefore(f,d.firstChild)}}}.call(this),function(){var a;a={prompterDiv:'<div id="coscreen_prompter">\n	Aweosme\n</div>',statusBarDiv:'<div id="coscreen_status_bar">\n	awesome bar\n</div>',script:document.getElementById("cobrowser"),prompter:document.getElementById("coscreen_prompter"),statusBar:document.getElementById("coscreen_status_bar"),init:function(){return window.CoScreenInit?void 0:(window.CoScreenInit=!0,a.append(a.prompterDiv),a.append(a.statusBarDiv),a.addStyles(),setTimeout(function(){return document.getElementById("coscreen_prompter").style.display="block",document.getElementById("coscreen_status_bar").style.display="block"},2e3))},addStyles:function(){var b,c;return c=a.script.getAttribute("data-stylesheet"),null===c&&(c="https://www.daljs.org/cobrowser.min.css"),b=document.createElement("link"),b.setAttribute("id","cobrowser_stylesheet"),b.setAttribute("rel","stylesheet"),b.setAttribute("type","text/css"),b.setAttribute("href",c),document.getElementsByTagName("head")[0].appendChild(b)},append:function(a,b){var c;return c=document.createElement("div"),c.innerHTML=a,document.querySelector(b||"body").appendChild(c.firstChild)}},a.init()}.call(this);